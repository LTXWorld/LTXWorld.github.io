<!doctype html><html lang=zh dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>K3sEP05â€”â€”å¼€å‘æ¿ä¸Šk3så­˜åœ¨çš„é—®é¢˜02_local-path-provisioner | LTX's Blog</title>
<meta name=keywords content="K3s,local-storage,RiscV"><meta name=description content="å¼•å­
æ¥ç€ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ç»§ç»­è§£å†³å¼€å‘æ¿ä¸Šçš„k3sé›†ç¾¤é‡åˆ°çš„é—®é¢˜ï¼Œå›é¡¾ä¸€ä¸‹ä¹‹å‰é‡åˆ°çš„é—®é¢˜ï¼Œä½¿ç”¨å‘½ä»¤æŸ¥çœ‹å½“å‰æ‰€æœ‰ Podsã€‚
kubectl get pods -A -o wide
NAMESPACE     NAME                                      READY   STATUS             RESTARTS        AGE    IP           NODE                NOMINATED NODE   READINESS GATES
default       redis-696579c6c8-v2wns                    1/1     Running            4 (4m10s ago)   7d6h   10.42.0.17   openeuler-riscv64   <none>           <none>
kube-system   helm-install-traefik-pv4hv                0/1     ImagePullBackOff   0               14d    10.42.0.20   openeuler-riscv64   <none>           <none>
kube-system   local-path-provisioner-7b7dc8d6f5-48jjf   0/1     ImagePullBackOff   0               14d    10.42.0.19   openeuler-riscv64   <none>           <none>
kube-system   helm-install-traefik-crd-ktfth            0/1     ImagePullBackOff   0               14d    10.42.0.21   openeuler-riscv64   <none>           <none>
kube-system   metrics-server-668d979685-jthzj           0/1     ImagePullBackOff   0               14d    10.42.0.22   openeuler-riscv64   <none>           <none>
kube-system   coredns-5f8bb7cf9f-5h5kj                  0/1     Running            0               11s    10.42.0.36   openeuler-riscv64   <none>           <none>
å¯ä»¥å‘ç°åœ¨ kube-system å‘½åç©ºé—´ä¸‹çš„è¿™äº› Pod è¿˜æ˜¯å¤„äº ImagePullBackOff é˜¶æ®µï¼Œåªæœ‰æˆ‘ä»¬ä¸Šæ¬¡è§£å†³çš„ CoreDNS æ˜¯ Runningï¼Œ
åªæ˜¯è¿˜å­˜åœ¨ç½‘ç»œé—®é¢˜æ²¡æœ‰è§£å†³,æ‰€ä»¥å¹¶æ²¡æœ‰ Ready."><meta name=author content="LTX"><link rel=canonical href=https://LTXWorld.github.io/posts/020k3sep05%E5%BC%80%E5%8F%91%E6%9D%BF%E4%B8%8Ak3s%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%9802/><link crossorigin=anonymous href=/assets/css/stylesheet.725ec5b3e73dcbb0ff6543a8256cd49aa2c4c02c9e0586f006beb2e1f1dec7f2.css integrity="sha256-cl7Fs+c9y7D/ZUOoJWzUmqLEwCyeBYbwBr6y4fHex/I=" rel="preload stylesheet" as=style><link rel=icon href=https://LTXWorld.github.io/favicon.png><link rel=icon type=image/png sizes=16x16 href=https://LTXWorld.github.io/favicon.png><link rel=icon type=image/png sizes=32x32 href=https://LTXWorld.github.io/favicon.png><link rel=apple-touch-icon href=https://LTXWorld.github.io/favicon.png><link rel=mask-icon href=https://LTXWorld.github.io/favicon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://LTXWorld.github.io/posts/020k3sep05%E5%BC%80%E5%8F%91%E6%9D%BF%E4%B8%8Ak3s%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%9802/><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap" rel=stylesheet><script type=text/javascript async src="https://cdn.bootcss.com/mathjax/2.7.3/MathJax.js?config=TeX-AMS-MML_HTMLorMML">MathJax.Hub.Config({tex2jax:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["[[","]]"]],processEscapes:!0,processEnvironments:!0,skipTags:["script","noscript","style","textarea","pre"],TeX:{equationNumbers:{autoNumber:"AMS"},extensions:["AMSmath.js","AMSsymbols.js"]}}}),MathJax.Hub.Queue(function(){var e,t=MathJax.Hub.getAllJax();for(e=0;e<t.length;e+=1)t[e].SourceElement().parentNode.className+=" has-jax"})</script><style>code.has-jax{font:inherit;font-size:100%;background:inherit;border:inherit;color:#515151}</style><meta property="og:url" content="https://LTXWorld.github.io/posts/020k3sep05%E5%BC%80%E5%8F%91%E6%9D%BF%E4%B8%8Ak3s%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%9802/"><meta property="og:site_name" content="LTX's Blog"><meta property="og:title" content="K3sEP05â€”â€”å¼€å‘æ¿ä¸Šk3så­˜åœ¨çš„é—®é¢˜02_local-path-provisioner"><meta property="og:description" content="å¼•å­ æ¥ç€ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ç»§ç»­è§£å†³å¼€å‘æ¿ä¸Šçš„k3sé›†ç¾¤é‡åˆ°çš„é—®é¢˜ï¼Œå›é¡¾ä¸€ä¸‹ä¹‹å‰é‡åˆ°çš„é—®é¢˜ï¼Œä½¿ç”¨å‘½ä»¤æŸ¥çœ‹å½“å‰æ‰€æœ‰ Podsã€‚
kubectl get pods -A -o wide NAMESPACE NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES default redis-696579c6c8-v2wns 1/1 Running 4 (4m10s ago) 7d6h 10.42.0.17 openeuler-riscv64 <none> <none> kube-system helm-install-traefik-pv4hv 0/1 ImagePullBackOff 0 14d 10.42.0.20 openeuler-riscv64 <none> <none> kube-system local-path-provisioner-7b7dc8d6f5-48jjf 0/1 ImagePullBackOff 0 14d 10.42.0.19 openeuler-riscv64 <none> <none> kube-system helm-install-traefik-crd-ktfth 0/1 ImagePullBackOff 0 14d 10.42.0.21 openeuler-riscv64 <none> <none> kube-system metrics-server-668d979685-jthzj 0/1 ImagePullBackOff 0 14d 10.42.0.22 openeuler-riscv64 <none> <none> kube-system coredns-5f8bb7cf9f-5h5kj 0/1 Running 0 11s 10.42.0.36 openeuler-riscv64 <none> <none> å¯ä»¥å‘ç°åœ¨ kube-system å‘½åç©ºé—´ä¸‹çš„è¿™äº› Pod è¿˜æ˜¯å¤„äº ImagePullBackOff é˜¶æ®µï¼Œåªæœ‰æˆ‘ä»¬ä¸Šæ¬¡è§£å†³çš„ CoreDNS æ˜¯ Runningï¼Œ åªæ˜¯è¿˜å­˜åœ¨ç½‘ç»œé—®é¢˜æ²¡æœ‰è§£å†³,æ‰€ä»¥å¹¶æ²¡æœ‰ Ready."><meta property="og:locale" content="zh"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2025-04-15T16:14:08+08:00"><meta property="article:modified_time" content="2025-04-15T16:14:08+08:00"><meta property="article:tag" content="K3s"><meta property="article:tag" content="Local-Storage"><meta property="article:tag" content="RiscV"><meta property="og:image" content="https://LTXWorld.github.io/images/papermod-cover.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://LTXWorld.github.io/images/papermod-cover.png"><meta name=twitter:title content="K3sEP05â€”â€”å¼€å‘æ¿ä¸Šk3så­˜åœ¨çš„é—®é¢˜02_local-path-provisioner"><meta name=twitter:description content="å¼•å­
æ¥ç€ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ç»§ç»­è§£å†³å¼€å‘æ¿ä¸Šçš„k3sé›†ç¾¤é‡åˆ°çš„é—®é¢˜ï¼Œå›é¡¾ä¸€ä¸‹ä¹‹å‰é‡åˆ°çš„é—®é¢˜ï¼Œä½¿ç”¨å‘½ä»¤æŸ¥çœ‹å½“å‰æ‰€æœ‰ Podsã€‚
kubectl get pods -A -o wide
NAMESPACE     NAME                                      READY   STATUS             RESTARTS        AGE    IP           NODE                NOMINATED NODE   READINESS GATES
default       redis-696579c6c8-v2wns                    1/1     Running            4 (4m10s ago)   7d6h   10.42.0.17   openeuler-riscv64   <none>           <none>
kube-system   helm-install-traefik-pv4hv                0/1     ImagePullBackOff   0               14d    10.42.0.20   openeuler-riscv64   <none>           <none>
kube-system   local-path-provisioner-7b7dc8d6f5-48jjf   0/1     ImagePullBackOff   0               14d    10.42.0.19   openeuler-riscv64   <none>           <none>
kube-system   helm-install-traefik-crd-ktfth            0/1     ImagePullBackOff   0               14d    10.42.0.21   openeuler-riscv64   <none>           <none>
kube-system   metrics-server-668d979685-jthzj           0/1     ImagePullBackOff   0               14d    10.42.0.22   openeuler-riscv64   <none>           <none>
kube-system   coredns-5f8bb7cf9f-5h5kj                  0/1     Running            0               11s    10.42.0.36   openeuler-riscv64   <none>           <none>
å¯ä»¥å‘ç°åœ¨ kube-system å‘½åç©ºé—´ä¸‹çš„è¿™äº› Pod è¿˜æ˜¯å¤„äº ImagePullBackOff é˜¶æ®µï¼Œåªæœ‰æˆ‘ä»¬ä¸Šæ¬¡è§£å†³çš„ CoreDNS æ˜¯ Runningï¼Œ
åªæ˜¯è¿˜å­˜åœ¨ç½‘ç»œé—®é¢˜æ²¡æœ‰è§£å†³,æ‰€ä»¥å¹¶æ²¡æœ‰ Ready."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://LTXWorld.github.io/posts/"},{"@type":"ListItem","position":2,"name":"K3sEP05â€”â€”å¼€å‘æ¿ä¸Šk3så­˜åœ¨çš„é—®é¢˜02_local-path-provisioner","item":"https://LTXWorld.github.io/posts/020k3sep05%E5%BC%80%E5%8F%91%E6%9D%BF%E4%B8%8Ak3s%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%9802/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"K3sEP05â€”â€”å¼€å‘æ¿ä¸Šk3så­˜åœ¨çš„é—®é¢˜02_local-path-provisioner","name":"K3sEP05â€”â€”å¼€å‘æ¿ä¸Šk3så­˜åœ¨çš„é—®é¢˜02_local-path-provisioner","description":"å¼•å­ æ¥ç€ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ç»§ç»­è§£å†³å¼€å‘æ¿ä¸Šçš„k3sé›†ç¾¤é‡åˆ°çš„é—®é¢˜ï¼Œå›é¡¾ä¸€ä¸‹ä¹‹å‰é‡åˆ°çš„é—®é¢˜ï¼Œä½¿ç”¨å‘½ä»¤æŸ¥çœ‹å½“å‰æ‰€æœ‰ Podsã€‚\nkubectl get pods -A -o wide NAMESPACE NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES default redis-696579c6c8-v2wns 1/1 Running 4 (4m10s ago) 7d6h 10.42.0.17 openeuler-riscv64 \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system helm-install-traefik-pv4hv 0/1 ImagePullBackOff 0 14d 10.42.0.20 openeuler-riscv64 \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system local-path-provisioner-7b7dc8d6f5-48jjf 0/1 ImagePullBackOff 0 14d 10.42.0.19 openeuler-riscv64 \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system helm-install-traefik-crd-ktfth 0/1 ImagePullBackOff 0 14d 10.42.0.21 openeuler-riscv64 \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system metrics-server-668d979685-jthzj 0/1 ImagePullBackOff 0 14d 10.42.0.22 openeuler-riscv64 \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; kube-system coredns-5f8bb7cf9f-5h5kj 0/1 Running 0 11s 10.42.0.36 openeuler-riscv64 \u0026lt;none\u0026gt; \u0026lt;none\u0026gt; å¯ä»¥å‘ç°åœ¨ kube-system å‘½åç©ºé—´ä¸‹çš„è¿™äº› Pod è¿˜æ˜¯å¤„äº ImagePullBackOff é˜¶æ®µï¼Œåªæœ‰æˆ‘ä»¬ä¸Šæ¬¡è§£å†³çš„ CoreDNS æ˜¯ Runningï¼Œ åªæ˜¯è¿˜å­˜åœ¨ç½‘ç»œé—®é¢˜æ²¡æœ‰è§£å†³,æ‰€ä»¥å¹¶æ²¡æœ‰ Ready.\n","keywords":["K3s","local-storage","RiscV"],"articleBody":"å¼•å­ æ¥ç€ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ç»§ç»­è§£å†³å¼€å‘æ¿ä¸Šçš„k3sé›†ç¾¤é‡åˆ°çš„é—®é¢˜ï¼Œå›é¡¾ä¸€ä¸‹ä¹‹å‰é‡åˆ°çš„é—®é¢˜ï¼Œä½¿ç”¨å‘½ä»¤æŸ¥çœ‹å½“å‰æ‰€æœ‰ Podsã€‚\nkubectl get pods -A -o wide NAMESPACE NAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES default redis-696579c6c8-v2wns 1/1 Running 4 (4m10s ago) 7d6h 10.42.0.17 openeuler-riscv64 kube-system helm-install-traefik-pv4hv 0/1 ImagePullBackOff 0 14d 10.42.0.20 openeuler-riscv64 kube-system local-path-provisioner-7b7dc8d6f5-48jjf 0/1 ImagePullBackOff 0 14d 10.42.0.19 openeuler-riscv64 kube-system helm-install-traefik-crd-ktfth 0/1 ImagePullBackOff 0 14d 10.42.0.21 openeuler-riscv64 kube-system metrics-server-668d979685-jthzj 0/1 ImagePullBackOff 0 14d 10.42.0.22 openeuler-riscv64 kube-system coredns-5f8bb7cf9f-5h5kj 0/1 Running 0 11s 10.42.0.36 openeuler-riscv64 å¯ä»¥å‘ç°åœ¨ kube-system å‘½åç©ºé—´ä¸‹çš„è¿™äº› Pod è¿˜æ˜¯å¤„äº ImagePullBackOff é˜¶æ®µï¼Œåªæœ‰æˆ‘ä»¬ä¸Šæ¬¡è§£å†³çš„ CoreDNS æ˜¯ Runningï¼Œ åªæ˜¯è¿˜å­˜åœ¨ç½‘ç»œé—®é¢˜æ²¡æœ‰è§£å†³,æ‰€ä»¥å¹¶æ²¡æœ‰ Ready.\næ‰€ä»¥è¿™æ¬¡æˆ‘ä»¬æ¥è§£å†³å…¶ä»– local-path-provisioner çš„é—®é¢˜ã€‚\nä»€ä¹ˆæ˜¯local-path-provisioner å®˜æ–¹çš„ä»‹ç»æ˜¯:Dynamically provisioning persistent local storage with Kubernetes\nä¼—æ‰€å‘¨çŸ¥ï¼Œå¦‚æœæˆ‘ä»¬èµ·ä¸€ä¸ª Podï¼Œé‡Œé¢çš„å®¹å™¨ä¸€å®šæ˜¯éœ€è¦æŒ‚è½½å¤–éƒ¨çš„å­˜å‚¨ç›®å½•çš„ï¼Œå¦åˆ™å®¹å™¨ä¸€æ—¦é”€æ¯é‚£ä¹ˆç›¸å…³çš„æ•°æ®ä¹Ÿä¸åœ¨äº†ï¼Œæ— æ³•åšåˆ°æŒä¹…åŒ–å­˜å‚¨ï¼Œè€ŒæŒ‚è½½å¤–éƒ¨å­˜å‚¨ç›®å½•æœ¬è´¨ä¸Šè¦æ±‚ PVCâ€”â€”æŒä¹…åŒ–å·å£°æ˜ï¼Œä¸¾ä¾‹è¯´æ˜ï¼š\nvolumeMounts: - mountPath: /data name: redis-storage volumes: - name: redis-storage persistentVolumeClaim: claimName: redis-data è¿™é‡Œæˆ‘ä»¬å£°æ˜äº†å…·ä½“çš„ pvc persistentVolumeClaim:claimName: redis-data,è¿™æ˜¯ä¸€ä¸ªçœŸæ­£çš„ç£ç›˜è·¯å¾„ï¼Œè§ä¸‹æ–¹ PVC çš„å£°æ˜å†™æ³•ã€‚\napiVersion: v1 kind: PersistentVolumeClaim metadata: name: redis-data spec: accessModes: - ReadWriteOnce resources: requests: storage: 1Gi ä¸€æ—¦å†™äº† PVCï¼Œlocal-path-provisioner å°±ä¼šèµ·ä½œç”¨ï¼šå®ƒè‡ªåŠ¨ä¸ºä½ çš„ PVC åˆ›å»ºä¸€ä¸ªç›®å½•, å¦‚ /opt/local-path-provisioner/pvc-xxx/,å°†æ­¤ç›®å½•æ˜ å°„ç»™å®¹å™¨ä½œä¸ºæŒä¹…åŒ–çš„ç›®å½•ã€‚ æ‰€ä»¥ï¼Œè¿™ä¸ªé•œåƒçš„ä¿®å¤æ˜¯è‡³å…³é‡è¦çš„ä¸€æ­¥ï¼Œæ²¡æœ‰å®ƒæˆ‘ä»¬å°±æ— æ³•è¿›è¡Œæ•°æ®çš„æŒä¹…åŒ–ã€‚\nä¿®å¤é—®é¢˜ ä¸CoreDNSä¸åŒçš„æ˜¯ï¼Œè¿™æ¬¡åœ¨å®˜æ–¹çš„ release ç•Œé¢å¹¶æ²¡æœ‰å‘ç°å…¶é’ˆå¯¹äºriscvæ¶æ„çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—å°è¯•è‡ªå·±æ„å»ºäº†ã€‚\n(åç»­æ›´æ–°,å‘ç°å…¶å·²ç»æ”¯æŒäº† RiscV æ¶æ„,åªæ˜¯æ²¡æœ‰è·‘é€šæµæ°´çº¿éƒ¨ç½²,ä½†æ˜¯ä»£ç ä¸­å·²ç» Commit äº†,æ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨äº†)\næ‹‰å–åˆ°å…¶æºä»£ç ä¹‹ååœ¨æˆ‘çš„ mac æœ¬æœºè¿›è¡Œæ„å»º\n1.æ„å»ºè‡ªå®šä¹‰é•œåƒ git clone git@github.com:rancher/local-path-provisioner.git cd local-path-provisioner GOOS=linux GOARCH=riscv64 CGO_ENABLED=0 go build -o local-path-provisioner æ„å»ºæˆåŠŸï¼Œè¿™è¯æ˜å…¶ä¸­å¹¶æ²¡æœ‰ä¸é€‚é…riscvçš„åœ°æ–¹ï¼ˆä¾‹å¦‚corednsä¸­æ„å»ºæ—¶å‡ºç°è¿‡çš„syscallä¸æ”¯æŒé—®é¢˜ï¼‰å¾—åˆ°ä¸€ä¸ªlocal-path-provisionerçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶å°è£…åœ¨ä¸€ä¸ªDockerfileä¸­æ„å»ºå…¶è‡ªå®šä¹‰çš„é•œåƒæ¥ä»£æ›¿é»˜è®¤çš„é•œåƒã€‚\ndockerfileå¦‚ä¸‹:æ³¨æ„æ‹·è´çš„è·¯å¾„é€‰æ‹©ä¸º/usr/bin\nFROM alpine:latest # ä½¿ç”¨é˜¿é‡Œæºï¼ˆå¯é€‰ï¼‰ RUN sed -i 's#https\\?://dl-cdn.alpinelinux.org/alpine#http://mirrors.aliyun.com/alpine#g' /etc/apk/repositories # æ‹·è´ç¼–è¯‘å¥½çš„å¯æ‰§è¡Œæ–‡ä»¶ COPY local-path-provisioner-riscv64 /usr/bin/local-path-provisioner # å¯åŠ¨å‘½ä»¤ ENTRYPOINT [\"local-path-provisioner\"] å¦‚æœä¸ä½¿ç”¨/usr/binçš„è¯ä¼šé‡åˆ°é—®é¢˜:\nEvents: Type Reason Age From Message ---- ------ ---- ---- ------- Normal Scheduled 79s default-scheduler Successfully assigned kube-system/local-path-provisioner-5cdfcc7d9c-hpqnm to openeuler-riscv64 Normal Pulled 35s (x4 over 79s) kubelet Container image \"ltx/local-path-provisioner:v0.0.21\" already present on machine Normal Created 35s (x4 over 79s) kubelet Created container local-path-provisioner Warning Failed 35s (x4 over 79s) kubelet Error: failed to create containerd task: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: exec: \"local-path-provisioner\": executable file not found in $PATH: unknown Warning BackOff 9s (x7 over 78s) kubelet Back-off restarting failed container æ„å»ºé•œåƒå¹¶æ¨é€è‡³æœ¬åœ°çš„ç§æœ‰é•œåƒä»“åº“ã€‚\ndocker build --network host --platform=linux/riscv64 -f Dockerfile.local-path-provisioner-riscv64 -t 192.168.173.76:6000/riscv64/local-path-provisioner:1.1 . docker push 192.168.173.76:6000/riscv64/local-path-provisioner:1.1 2.æ‹‰å–é•œåƒä¿®æ”¹é…ç½®æ–‡ä»¶ åœ¨ riscv å¼€å‘æ¿è¿›è¡Œæ‹‰å–é•œåƒå¹¶æ‰“æ ‡ç­¾è‡³é»˜è®¤ local-storage ä¸­æŒ‡æ˜çš„é•œåƒåç§°ã€‚\ncrictl pull riscv64/local-path-provisioner:1.1 ctr -n k8s.io images tag docker.io/riscv64/local-path-provisioner:1.1 docker.io/rancher/local-path-provisioner:v.0.0.21 å¯ä»¥ä½¿ç”¨ kubectl -n kube-system edit deployment local-path-provisioner æ£€æŸ¥å…¶Deploymentæ–‡ä»¶;\næˆ–è€…ä¸coreDNSç›¸åŒ,è¿›å…¥ /var/lib/rancher/k3s/server/manifests ç›®å½•ä¸‹æŸ¥çœ‹å…¶ local-storage.yaml æ–‡ä»¶. è¿™æ˜¯local-path-provisionerçš„éƒ¨ç½²æ–‡ä»¶ã€‚\nå¦‚æœæœªèƒ½è¯†åˆ«åˆ°æœ¬åœ°é•œåƒï¼Œæ ¹æ®è¿™ä¸ªå›ç­”ï¼Œæˆ‘ä»¬åªè¦ä¿®æ”¹å‰ç¼€ä¸æ˜¯rancherçš„å°±å¯ä»¥è¯†åˆ«åˆ°æœ¬åœ°çš„é•œåƒ\næ¥ä¸‹æ¥ä¸ coreDNS ç›¸åŒï¼Œè¿™æ˜¯ç³»ç»Ÿçº§åˆ«çš„é•œåƒï¼Œä¸ºäº†é˜²æ­¢æ¯æ¬¡é‡å¯éƒ½è¢«è¦†ç›–ï¼Œéœ€è¦åœ¨k3så¯åŠ¨å‘½ä»¤ä¸­æ·»åŠ --disableæ ‡ç­¾. å› ä¸ºæˆ‘ä»¬ä½¿ç”¨systemctlæ¥ç®¡ç†k3sï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹/etc/systemd/system/k3s.service\nåœ¨æ­¤ä¹‹å‰æˆ‘ä»¬è¦å…ˆæ‹·è´ä¸€ä»½manifestsç›®å½•ä¸‹çš„yamlæ–‡ä»¶ï¼Œä¿®æ”¹ä¸ºæˆ‘ä»¬è‡ªå®šä¹‰çš„custom-local-storage.yamlæ–‡ä»¶ï¼Œè®©ä¹‹åçš„k3sè¯†åˆ«åˆ°è¿™ä¸ªæ–‡ä»¶è¿›è¡Œå®¹å™¨çš„æ„å»ºã€‚\ncp local-storage.yaml custom-local-storage.yaml ç”±äºæˆ‘ä»¬ä¹‹å‰å·²ç»æŠŠæ ‡ç­¾æ‰“æˆäº†ä¸é»˜è®¤ yaml æ–‡ä»¶ä¸­ç›¸åŒåç§°çš„é•œåƒï¼Œæ‰€ä»¥è¿™ä¸ª custom æ–‡ä»¶ä¸­ä¸éœ€è¦ä¿®æ”¹ä»€ä¹ˆä¸œè¥¿ã€‚\nå›åˆ°åˆšæ‰ï¼Œç»§ç»­ä¿®æ”¹å¯åŠ¨å‘½ä»¤ã€‚\nvi /etc/systemd/system/k3s.service # åœ¨ExecStartä¸­æ·»åŠ  --disable ExecStart=/usr/local/bin/k3s \\ server \\ --disable=local-storage,coredns \\ è¿™ä¸€æ–¹æ³•æ¥æºäºå®˜æ–¹æ–‡æ¡£ï¼Œæˆ–è€…è¿™ç¯‡æ–‡ç« ï¼ŒåŠ ä¸Šè¿™ä¸ªæ ‡ç­¾ä¼šä½¿k3såœ¨å¯åŠ¨æ—¶é€‰æ‹©æˆ‘ä»¬è®¾å®šçš„è‡ªå®šä¹‰yamlæ–‡ä»¶å¹¶ä¸”åˆ é™¤é»˜è®¤çš„yamlæ–‡ä»¶ä¸æ„å»ºçš„å®¹å™¨ã€‚\nä½ è¿˜å¯ä»¥é€‰æ‹©æ–‡ç« ä¸­çš„æ–¹æ³•äºŒï¼Œåœ¨manifestsç›®å½•ä¸‹æ·»åŠ  local-storage.yaml.skip æ–‡ä»¶ï¼Œè¿™æ ·ä¼šè®©k3sè·³è¿‡æŸä¸ªå®¹å™¨çš„æ„å»ºï¼Œä½†æˆ‘æ²¡æœ‰æµ‹è¯•å…¶æ˜¯å¦ä¼šå»é€‰æ‹©æˆ‘ä»¬è‡ªå®šä¹‰çš„é…ç½®æ–‡ä»¶ã€‚\næ¥ä¸‹æ¥è¿›è¡Œåˆ é™¤ï¼Œæ£€æµ‹ã€‚æœ€å¥½é‡å¯ä¸€ä¸‹k3s,systemctl restart k3s\nkubectl delete pod -n kube-system -l app=local-path-provisioner kubectl get pods -n kube-system -l app=local-path-provisioner kubectl describe pod -n kube-system æ€»ç»“ ç»å†äº† coreDNS å’Œ local-path-provisioner è¿™ä¸¤ä¸ªç³»ç»Ÿçº§åˆ«çš„é•œåƒä¹‹åï¼Œæˆ‘å¼€å§‹åæ€æ•´ä¸ªé€‚é…è¿‡ç¨‹ï¼Œæˆ‘è§‰å¾—åº”è¯¥å…ˆå»çœ‹çœ‹å¦‚ä½•ä»å¤´é€‚é…ï¼Œå³ä½¿ OREV çš„å…´è¶£å°ç»„å…ˆè¿›è¡Œäº†ä¸€ä¸ªåŸºç¡€é€‚é…ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥å…ˆä¸‹è½½åˆ° k3sã€‚\ngoogle åå‘ç°åœ¨å®˜æ–¹çš„ISSUEä¸­æœ‰è¿™ä¸ªé€‚é…é—®é¢˜,å…¶ä¸­æåˆ°ä¸€ä¸ªå·¨å¤§æŒ‘æˆ˜æ˜¯rancher-mirrored é•œåƒä¸­ç¼ºä¹å¯¹ riscv å¹³å°çš„æ”¯æŒã€‚\nè¿™ä¹Ÿæ­£æ˜¯æˆ‘ä»¬ä¹‹å‰å¤„ç†çš„é‚£äº›é•œåƒï¼Œé»˜è®¤æ˜¯æ‹‰å–çš„ rancher å®˜æ–¹ç»´æŠ¤çš„é•œåƒå‰¯æœ¬ rancher-mirrored,æˆ‘ä»¬ä¹Ÿå¯¹è¿™äº›é•œåƒåšäº†é€‚é…ã€‚(åæ¥çŸ¥é“å¯ä»¥ä¿®æ”¹é»˜è®¤é•œåƒä»“åº“,åœ¨å¯åŠ¨å‘½ä»¤æ—¶åŠ ä¸Šç§æœ‰çš„ä»“åº“å³å¯)\nWhile we could simply add this to the arch list, this would change the multi-arch digest for any tags that we currently mirror that have this platform available.\nä¸‹é¢ä¹Ÿæåˆ°è™½ç„¶å¯ä»¥ç®€å•åœ°å°† riscv æ·»åŠ åˆ°é•œåƒçš„æ¶æ„åˆ—è¡¨ä¸­ï¼Œä½†ä¼šå¯¼è‡´å½“å‰é•œåƒçš„å¤šæ¶æ„ digest å‘ç”Ÿå˜åŒ–ã€‚\né•œåƒçš„ digest æ˜¯é•œåƒçš„å”¯ä¸€æ ‡è¯†ï¼Œä¸€ä¸ªå“ˆå¸Œå€¼ sha256:xxx æˆ‘ä»¬å¹³æ—¶ç”¨çš„é•œåƒåç§°ï¼Œå…¶å®å°±æ˜¯ tagï¼ŒæŒ‡å‘çš„æ˜¯ä¸€ä¸ªå¤šæ¶æ„çš„manifest,è¿™ä¸ª manifest ä¼šåˆ—å‡ºæ‰€æœ‰å¯¹åº”æ¶æ„çš„é•œåƒ(è§ä¸‹æ–¹å›¾åƒ) manifest list æœ¬èº«æ˜¯ä¸€ä¸ª JSON æ–‡ä»¶,ä»–ä¹Ÿæœ‰ digest æ ‡è¯†;å¦‚æœæ·»åŠ ä¸€ä¸ª riscv å­—æ®µè¿›å»ï¼Œæ•´ä¸ª JSON å†…å®¹å˜åŒ–å¯¼è‡´ digest å˜åŒ– å¾ˆå¤šç”Ÿäº§ç³»ç»Ÿ,CI/CD éƒ½ä¾èµ–è¿™ä¸ªç¨³å®šå¯éªŒè¯çš„ digest,è¿™å°±å¯¼è‡´ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«, ä¼šé‡æ–°æ‹‰å–é•œåƒï¼Œæ‰“ç ´ç¼“å­˜ï¼›æŸäº›ç³»ç»Ÿä¼šè¯¯ä»¥ä¸ºå†…å®¹è¢«ç¯¡æ”¹æˆ–æ›´æ–°äº†ï¼Œé€ æˆæ„å¤–åæœ;ä¸åˆ©äºé•œåƒçš„åŒæ­¥å’Œç®¡ç† æ›´æ„¿æ„çš„åšæ³•æ˜¯:ä¸æ”¹å˜ç°æœ‰ç‰ˆæœ¬(åŠä¹‹å‰ç‰ˆæœ¬)çš„é•œåƒ manifest,åœ¨æ–°çš„ç‰ˆæœ¬ä¸­æ·»åŠ å¯¹æ–°æ¶æ„çš„æ”¯æŒ. We should figure out how to add this platform to only new tags, in a way that is minimally disruptive to the list maintenance process, and can be reused when adding new platforms in the future.\nè¿™æ˜¯ä»–ä»¬æå‡ºçš„è§£å†³æ–¹æ³•ï¼Œåªå°† RISC-V å¹³å°æ·»åŠ åˆ°**æ–°æ ‡ç­¾ï¼ˆæ–°çš„ manifest,æ–°çš„é•œåƒï¼‰**ä¸­ï¼Œè¿™æ ·å¯¹é•œåƒåˆ—è¡¨çš„ç»´æŠ¤å¹²æ‰°æœ€å°ã€‚\nä¸ºäº†ä¿è¯é•œåƒçš„ç¨³å®šæ€§ï¼ŒK3s å›¢é˜Ÿä¸ä¿®æ”¹å·²æœ‰é•œåƒçš„å¤šæ¶æ„é…ç½®ï¼Œè€Œæ˜¯åªç»™æ–°æ·»åŠ çš„é•œåƒæ„å»º RISC-V ç‰ˆæœ¬ï¼Œé  git blame + æ—¶é—´åŒºé—´æ§åˆ¶ï¼Œç¡®ä¿ digest ä¸å˜ä¸”æµç¨‹å¯å¤ç”¨ã€‚\nä½†æ˜¯åç»­çš„è®¨è®ºå°±å›´ç»•ç€è¯¥å¦‚ä½•æ”¯æŒæ–°çš„æ¶æ„ï¼Œå®˜æ–¹å¼€å‘è€…æ›´å€¾å‘äºå¯¹æ–°çš„é•œåƒåŠ å…¥æ–°çš„æ¶æ„è€Œä¸å»æ”¹åŠ¨è€çš„é•œåƒï¼Œè¿™æ˜¯å¾ˆå¥½ç†è§£çš„ç­–ç•¥ã€‚\næ¥ä¸‹æ¥æˆ‘ä»¬å°†æ¢ç´¢å…¶ä»–ç³»ç»Ÿçº§åˆ«é•œåƒ,ä¾‹å¦‚ Helm,Traefik\nè¿™é‡Œæ˜¯LTXï¼Œæ„Ÿè°¢æ‚¨é˜…è¯»è¿™ç¯‡åšå®¢ï¼Œäººç”Ÿæµ·æµ·ï¼Œå’Œè‡ªå·±å¯¹è¯ï¼Œåƒåªè´è¶çºµæ¨ªå››æµ·ã€‚\nåç»­æ›´æ–° å¯ä»¥å‘ç° rancher å®˜æ–¹æä¾›äº†å…³äº local-path-provisioner åœ¨ riscv ä¸Šçš„é•œåƒ.\næ‰€ä»¥å¤§ä½¬åœ¨ commit ä¸­åªæ˜¯ä¿®æ”¹äº†å…¶ç‰ˆæœ¬åˆ°29.\næ•…æˆ‘ä»¬åªéœ€è¦å°†å…¶æ‹‰å–åˆ°æœ¬åœ°å¹¶æ¨é€åˆ°ç§æœ‰é•œåƒä»“åº“å³å¯.\n","wordCount":"2675","inLanguage":"zh","image":"https://LTXWorld.github.io/images/papermod-cover.png","datePublished":"2025-04-15T16:14:08+08:00","dateModified":"2025-04-15T16:14:08+08:00","author":{"@type":"Person","name":"LTX"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://LTXWorld.github.io/posts/020k3sep05%E5%BC%80%E5%8F%91%E6%9D%BF%E4%B8%8Ak3s%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%9802/"},"publisher":{"@type":"Organization","name":"LTX's Blog","logo":{"@type":"ImageObject","url":"https://LTXWorld.github.io/favicon.png"}}}</script></head><body class=dark id=top><script>localStorage.getItem("pref-theme")==="light"&&document.body.classList.remove("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://LTXWorld.github.io/ accesskey=h title="LTX's Blog (Alt + H)">LTX's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://LTXWorld.github.io/ title="LTX's Blog"><span>é¦–é¡µ</span></a></li><li><a href=https://LTXWorld.github.io/archives/ title=å½’æ¡£><span>å½’æ¡£</span></a></li><li><a href=https://LTXWorld.github.io/categories/ title=Categories><span>åˆ†ç±»</span></a></li><li><a href=https://LTXWorld.github.io/tags/ title=Tags><span>æ ‡ç­¾</span></a></li><li><a href=https://LTXWorld.github.io/search/ title=æœç´¢><span>æœç´¢</span></a></li><li><a href=https://LTXWorld.github.io/about/ title=åèŠ±å›­><span>å…³äº</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">K3sEP05â€”â€”å¼€å‘æ¿ä¸Šk3så­˜åœ¨çš„é—®é¢˜02_local-path-provisioner</h1><div class=post-meta><span title='2025-04-15 16:14:08 +0800 CST'>å››æœˆ 15, 2025</span>&nbsp;Â·&nbsp;6 åˆ†é’Ÿ&nbsp;Â·&nbsp;LTX</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>ç›®å½•</span></summary><div class=inner><ul><li><a href=#%e5%bc%95%e5%ad%90 aria-label=å¼•å­>å¼•å­</a></li><li><a href=#%e4%bb%80%e4%b9%88%e6%98%aflocal-path-provisioner aria-label=ä»€ä¹ˆæ˜¯local-path-provisioner>ä»€ä¹ˆæ˜¯local-path-provisioner</a></li><li><a href=#%e4%bf%ae%e5%a4%8d%e9%97%ae%e9%a2%98 aria-label=ä¿®å¤é—®é¢˜>ä¿®å¤é—®é¢˜</a><ul><li><a href=#1%e6%9e%84%e5%bb%ba%e8%87%aa%e5%ae%9a%e4%b9%89%e9%95%9c%e5%83%8f aria-label=1.æ„å»ºè‡ªå®šä¹‰é•œåƒ>1.æ„å»ºè‡ªå®šä¹‰é•œåƒ</a></li><li><a href=#2%e6%8b%89%e5%8f%96%e9%95%9c%e5%83%8f%e4%bf%ae%e6%94%b9%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6 aria-label=2.æ‹‰å–é•œåƒä¿®æ”¹é…ç½®æ–‡ä»¶>2.æ‹‰å–é•œåƒä¿®æ”¹é…ç½®æ–‡ä»¶</a></li></ul></li><li><a href=#%e6%80%bb%e7%bb%93 aria-label=æ€»ç»“>æ€»ç»“</a></li><li><a href=#%e5%90%8e%e7%bb%ad%e6%9b%b4%e6%96%b0 aria-label=åç»­æ›´æ–°>åç»­æ›´æ–°</a></li></ul></div></details></div><div class=post-content><h2 id=å¼•å­>å¼•å­<a hidden class=anchor aria-hidden=true href=#å¼•å­>#</a></h2><p>æ¥ç€ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬ç»§ç»­è§£å†³å¼€å‘æ¿ä¸Šçš„k3sé›†ç¾¤é‡åˆ°çš„é—®é¢˜ï¼Œå›é¡¾ä¸€ä¸‹ä¹‹å‰é‡åˆ°çš„é—®é¢˜ï¼Œä½¿ç”¨å‘½ä»¤æŸ¥çœ‹å½“å‰æ‰€æœ‰ Podsã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl get pods -A -o wide
</span></span><span class=line><span class=cl>NAMESPACE     NAME                                      READY   STATUS             RESTARTS        AGE    IP           NODE                NOMINATED NODE   READINESS GATES
</span></span><span class=line><span class=cl>default       redis-696579c6c8-v2wns                    1/1     Running            <span class=m>4</span> <span class=o>(</span>4m10s ago<span class=o>)</span>   7d6h   10.42.0.17   openeuler-riscv64   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>kube-system   helm-install-traefik-pv4hv                0/1     ImagePullBackOff   <span class=m>0</span>               14d    10.42.0.20   openeuler-riscv64   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>kube-system   local-path-provisioner-7b7dc8d6f5-48jjf   0/1     ImagePullBackOff   <span class=m>0</span>               14d    10.42.0.19   openeuler-riscv64   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>kube-system   helm-install-traefik-crd-ktfth            0/1     ImagePullBackOff   <span class=m>0</span>               14d    10.42.0.21   openeuler-riscv64   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>kube-system   metrics-server-668d979685-jthzj           0/1     ImagePullBackOff   <span class=m>0</span>               14d    10.42.0.22   openeuler-riscv64   &lt;none&gt;           &lt;none&gt;
</span></span><span class=line><span class=cl>kube-system   coredns-5f8bb7cf9f-5h5kj                  0/1     Running            <span class=m>0</span>               11s    10.42.0.36   openeuler-riscv64   &lt;none&gt;           &lt;none&gt;
</span></span></code></pre></div><p>å¯ä»¥å‘ç°åœ¨ kube-system å‘½åç©ºé—´ä¸‹çš„è¿™äº› Pod è¿˜æ˜¯å¤„äº ImagePullBackOff é˜¶æ®µï¼Œåªæœ‰æˆ‘ä»¬ä¸Šæ¬¡è§£å†³çš„ CoreDNS æ˜¯ Runningï¼Œ
åªæ˜¯è¿˜å­˜åœ¨ç½‘ç»œé—®é¢˜æ²¡æœ‰è§£å†³,æ‰€ä»¥å¹¶æ²¡æœ‰ Ready.</p><p>æ‰€ä»¥è¿™æ¬¡æˆ‘ä»¬æ¥è§£å†³å…¶ä»– local-path-provisioner çš„é—®é¢˜ã€‚</p><h2 id=ä»€ä¹ˆæ˜¯local-path-provisioner>ä»€ä¹ˆæ˜¯local-path-provisioner<a hidden class=anchor aria-hidden=true href=#ä»€ä¹ˆæ˜¯local-path-provisioner>#</a></h2><p>å®˜æ–¹çš„ä»‹ç»æ˜¯:<strong>Dynamically provisioning persistent local storage with Kubernetes</strong></p><p>ä¼—æ‰€å‘¨çŸ¥ï¼Œå¦‚æœæˆ‘ä»¬èµ·ä¸€ä¸ª Podï¼Œé‡Œé¢çš„å®¹å™¨ä¸€å®šæ˜¯éœ€è¦æŒ‚è½½å¤–éƒ¨çš„å­˜å‚¨ç›®å½•çš„ï¼Œå¦åˆ™å®¹å™¨ä¸€æ—¦é”€æ¯é‚£ä¹ˆç›¸å…³çš„æ•°æ®ä¹Ÿä¸åœ¨äº†ï¼Œæ— æ³•åšåˆ°æŒä¹…åŒ–å­˜å‚¨ï¼Œè€ŒæŒ‚è½½å¤–éƒ¨å­˜å‚¨ç›®å½•æœ¬è´¨ä¸Šè¦æ±‚ PVCâ€”â€”æŒä¹…åŒ–å·å£°æ˜ï¼Œä¸¾ä¾‹è¯´æ˜ï¼š</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>volumeMounts</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>mountPath</span><span class=p>:</span><span class=w> </span><span class=l>/data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>redis-storage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>volumes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span>- <span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>redis-storage</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>persistentVolumeClaim</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>claimName</span><span class=p>:</span><span class=w> </span><span class=l>redis-data</span><span class=w>
</span></span></span></code></pre></div><p>è¿™é‡Œæˆ‘ä»¬å£°æ˜äº†å…·ä½“çš„ pvc <code>persistentVolumeClaim:claimName: redis-data</code>,è¿™æ˜¯ä¸€ä¸ªçœŸæ­£çš„ç£ç›˜è·¯å¾„ï¼Œè§ä¸‹æ–¹ PVC çš„å£°æ˜å†™æ³•ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class=l>v1</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class=l>PersistentVolumeClaim</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>metadata</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class=l>redis-data</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nt>spec</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>accessModes</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span>- <span class=l>ReadWriteOnce</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>resources</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>    </span><span class=nt>requests</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>      </span><span class=nt>storage</span><span class=p>:</span><span class=w> </span><span class=l>1Gi</span><span class=w>
</span></span></span></code></pre></div><p>ä¸€æ—¦å†™äº† PVCï¼Œlocal-path-provisioner å°±ä¼šèµ·ä½œç”¨ï¼šå®ƒè‡ªåŠ¨ä¸ºä½ çš„ PVC åˆ›å»ºä¸€ä¸ªç›®å½•,
å¦‚ <code>/opt/local-path-provisioner/pvc-xxx/</code>,å°†æ­¤ç›®å½•æ˜ å°„ç»™å®¹å™¨ä½œä¸ºæŒä¹…åŒ–çš„ç›®å½•ã€‚
æ‰€ä»¥ï¼Œè¿™ä¸ªé•œåƒçš„ä¿®å¤æ˜¯è‡³å…³é‡è¦çš„ä¸€æ­¥ï¼Œæ²¡æœ‰å®ƒæˆ‘ä»¬å°±æ— æ³•è¿›è¡Œæ•°æ®çš„æŒä¹…åŒ–ã€‚</p><h2 id=ä¿®å¤é—®é¢˜>ä¿®å¤é—®é¢˜<a hidden class=anchor aria-hidden=true href=#ä¿®å¤é—®é¢˜>#</a></h2><p>ä¸CoreDNSä¸åŒçš„æ˜¯ï¼Œè¿™æ¬¡åœ¨å®˜æ–¹çš„ release ç•Œé¢å¹¶æ²¡æœ‰å‘ç°å…¶é’ˆå¯¹äºriscvæ¶æ„çš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬å¾—å°è¯•è‡ªå·±æ„å»ºäº†ã€‚</p><p>(åç»­æ›´æ–°,å‘ç°å…¶å·²ç»æ”¯æŒäº† RiscV æ¶æ„,åªæ˜¯æ²¡æœ‰è·‘é€šæµæ°´çº¿éƒ¨ç½²,ä½†æ˜¯ä»£ç ä¸­å·²ç» Commit äº†,æ‰€ä»¥å¯ä»¥ç›´æ¥ä½¿ç”¨äº†)</p><p>æ‹‰å–åˆ°å…¶æºä»£ç ä¹‹ååœ¨æˆ‘çš„ mac æœ¬æœºè¿›è¡Œæ„å»º</p><h3 id=1æ„å»ºè‡ªå®šä¹‰é•œåƒ>1.æ„å»ºè‡ªå®šä¹‰é•œåƒ<a hidden class=anchor aria-hidden=true href=#1æ„å»ºè‡ªå®šä¹‰é•œåƒ>#</a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>git clone git@github.com:rancher/local-path-provisioner.git
</span></span><span class=line><span class=cl><span class=nb>cd</span> local-path-provisioner
</span></span><span class=line><span class=cl><span class=nv>GOOS</span><span class=o>=</span>linux <span class=nv>GOARCH</span><span class=o>=</span>riscv64 <span class=nv>CGO_ENABLED</span><span class=o>=</span><span class=m>0</span> go build -o local-path-provisioner
</span></span></code></pre></div><p>æ„å»ºæˆåŠŸï¼Œè¿™è¯æ˜å…¶ä¸­å¹¶æ²¡æœ‰ä¸é€‚é…riscvçš„åœ°æ–¹ï¼ˆä¾‹å¦‚corednsä¸­æ„å»ºæ—¶å‡ºç°è¿‡çš„syscallä¸æ”¯æŒé—®é¢˜ï¼‰å¾—åˆ°ä¸€ä¸ªlocal-path-provisionerçš„äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶å°è£…åœ¨ä¸€ä¸ªDockerfileä¸­æ„å»ºå…¶è‡ªå®šä¹‰çš„é•œåƒæ¥ä»£æ›¿é»˜è®¤çš„é•œåƒã€‚</p><p>dockerfileå¦‚ä¸‹:æ³¨æ„æ‹·è´çš„è·¯å¾„é€‰æ‹©ä¸º<code>/usr/bin</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dockerfile data-lang=dockerfile><span class=line><span class=cl><span class=k>FROM</span><span class=s> alpine:latest</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># ä½¿ç”¨é˜¿é‡Œæºï¼ˆå¯é€‰ï¼‰</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>RUN</span> sed -i <span class=s1>&#39;s#https\?://dl-cdn.alpinelinux.org/alpine#http://mirrors.aliyun.com/alpine#g&#39;</span> /etc/apk/repositories<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># æ‹·è´ç¼–è¯‘å¥½çš„å¯æ‰§è¡Œæ–‡ä»¶</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>COPY</span> local-path-provisioner-riscv64 /usr/bin/local-path-provisioner<span class=err>
</span></span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=c># å¯åŠ¨å‘½ä»¤</span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=k>ENTRYPOINT</span> <span class=p>[</span><span class=s2>&#34;local-path-provisioner&#34;</span><span class=p>]</span><span class=err>
</span></span></span></code></pre></div><p>å¦‚æœä¸ä½¿ç”¨<code>/usr/bin</code>çš„è¯ä¼šé‡åˆ°é—®é¢˜:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Events:
</span></span><span class=line><span class=cl>  Type     Reason     Age                From               Message
</span></span><span class=line><span class=cl>  ----     ------     ----               ----               -------
</span></span><span class=line><span class=cl>  Normal   Scheduled  79s                default-scheduler  Successfully assigned kube-system/local-path-provisioner-5cdfcc7d9c-hpqnm to openeuler-riscv64
</span></span><span class=line><span class=cl>  Normal   Pulled     35s <span class=o>(</span>x4 over 79s<span class=o>)</span>  kubelet            Container image <span class=s2>&#34;ltx/local-path-provisioner:v0.0.21&#34;</span> already present on machine
</span></span><span class=line><span class=cl>  Normal   Created    35s <span class=o>(</span>x4 over 79s<span class=o>)</span>  kubelet            Created container local-path-provisioner
</span></span><span class=line><span class=cl>  Warning  Failed     35s <span class=o>(</span>x4 over 79s<span class=o>)</span>  kubelet            Error: failed to create containerd task: failed to create shim task: OCI runtime create failed: runc create failed: unable to start container process: exec: <span class=s2>&#34;local-path-provisioner&#34;</span>: executable file not found in <span class=nv>$PATH</span>: unknown
</span></span><span class=line><span class=cl>  Warning  BackOff    9s <span class=o>(</span>x7 over 78s<span class=o>)</span>   kubelet            Back-off restarting failed container
</span></span></code></pre></div><p>æ„å»ºé•œåƒå¹¶æ¨é€è‡³æœ¬åœ°çš„ç§æœ‰é•œåƒä»“åº“ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>docker build --network host --platform<span class=o>=</span>linux/riscv64 -f Dockerfile.local-path-provisioner-riscv64 -t 192.168.173.76:6000/riscv64/local-path-provisioner:1.1 .
</span></span><span class=line><span class=cl>docker push 192.168.173.76:6000/riscv64/local-path-provisioner:1.1
</span></span></code></pre></div><h3 id=2æ‹‰å–é•œåƒä¿®æ”¹é…ç½®æ–‡ä»¶>2.æ‹‰å–é•œåƒä¿®æ”¹é…ç½®æ–‡ä»¶<a hidden class=anchor aria-hidden=true href=#2æ‹‰å–é•œåƒä¿®æ”¹é…ç½®æ–‡ä»¶>#</a></h3><p>åœ¨ riscv å¼€å‘æ¿è¿›è¡Œæ‹‰å–é•œåƒå¹¶æ‰“æ ‡ç­¾è‡³é»˜è®¤ local-storage ä¸­æŒ‡æ˜çš„é•œåƒåç§°ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>crictl pull riscv64/local-path-provisioner:1.1
</span></span><span class=line><span class=cl>ctr -n k8s.io images tag docker.io/riscv64/local-path-provisioner:1.1 docker.io/rancher/local-path-provisioner:v.0.0.21
</span></span></code></pre></div><p>å¯ä»¥ä½¿ç”¨ <code>kubectl -n kube-system edit deployment local-path-provisioner</code> æ£€æŸ¥å…¶Deploymentæ–‡ä»¶;</p><p>æˆ–è€…ä¸coreDNSç›¸åŒ,è¿›å…¥ <code>/var/lib/rancher/k3s/server/manifests</code> ç›®å½•ä¸‹æŸ¥çœ‹å…¶ <code>local-storage.yaml</code> æ–‡ä»¶.
è¿™æ˜¯local-path-provisionerçš„éƒ¨ç½²æ–‡ä»¶ã€‚</p><p>å¦‚æœæœªèƒ½è¯†åˆ«åˆ°æœ¬åœ°é•œåƒï¼Œæ ¹æ®è¿™ä¸ª<a href=https://github.com/k3s-io/k3s/issues/7015>å›ç­”</a>ï¼Œæˆ‘ä»¬åªè¦ä¿®æ”¹å‰ç¼€ä¸æ˜¯rancherçš„å°±å¯ä»¥è¯†åˆ«åˆ°æœ¬åœ°çš„é•œåƒ</p><p>æ¥ä¸‹æ¥ä¸ coreDNS ç›¸åŒï¼Œè¿™æ˜¯ç³»ç»Ÿçº§åˆ«çš„é•œåƒï¼Œä¸ºäº†é˜²æ­¢æ¯æ¬¡é‡å¯éƒ½è¢«è¦†ç›–ï¼Œéœ€è¦åœ¨k3så¯åŠ¨å‘½ä»¤ä¸­æ·»åŠ <code>--disable</code>æ ‡ç­¾.
å› ä¸ºæˆ‘ä»¬ä½¿ç”¨systemctlæ¥ç®¡ç†k3sï¼Œæ‰€ä»¥éœ€è¦ä¿®æ”¹<code>/etc/systemd/system/k3s.service</code></p><p>åœ¨æ­¤ä¹‹å‰æˆ‘ä»¬è¦å…ˆæ‹·è´ä¸€ä»½manifestsç›®å½•ä¸‹çš„yamlæ–‡ä»¶ï¼Œä¿®æ”¹ä¸ºæˆ‘ä»¬è‡ªå®šä¹‰çš„custom-local-storage.yamlæ–‡ä»¶ï¼Œè®©ä¹‹åçš„k3sè¯†åˆ«åˆ°è¿™ä¸ªæ–‡ä»¶è¿›è¡Œå®¹å™¨çš„æ„å»ºã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>cp local-storage.yaml custom-local-storage.yaml
</span></span></code></pre></div><p>ç”±äºæˆ‘ä»¬ä¹‹å‰å·²ç»æŠŠæ ‡ç­¾æ‰“æˆäº†ä¸é»˜è®¤ yaml æ–‡ä»¶ä¸­ç›¸åŒåç§°çš„é•œåƒï¼Œæ‰€ä»¥è¿™ä¸ª custom æ–‡ä»¶ä¸­ä¸éœ€è¦ä¿®æ”¹ä»€ä¹ˆä¸œè¥¿ã€‚</p><p>å›åˆ°åˆšæ‰ï¼Œç»§ç»­ä¿®æ”¹å¯åŠ¨å‘½ä»¤ã€‚</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>vi /etc/systemd/system/k3s.service
</span></span><span class=line><span class=cl><span class=c1># åœ¨ExecStartä¸­æ·»åŠ  --disable</span>
</span></span><span class=line><span class=cl><span class=nv>ExecStart</span><span class=o>=</span>/usr/local/bin/k3s <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    server <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --disable<span class=o>=</span>local-storage,coredns <span class=se>\
</span></span></span></code></pre></div><p>è¿™ä¸€æ–¹æ³•æ¥æºäºå®˜æ–¹æ–‡æ¡£ï¼Œæˆ–è€…<a href=https://medium.com/@bilsted/how-to-disable-traefik-and-metrics-server-on-k3s-b7dab4ca3aae>è¿™ç¯‡æ–‡ç« </a>ï¼ŒåŠ ä¸Šè¿™ä¸ªæ ‡ç­¾ä¼šä½¿k3såœ¨å¯åŠ¨æ—¶é€‰æ‹©æˆ‘ä»¬è®¾å®šçš„è‡ªå®šä¹‰yamlæ–‡ä»¶å¹¶ä¸”åˆ é™¤é»˜è®¤çš„yamlæ–‡ä»¶ä¸æ„å»ºçš„å®¹å™¨ã€‚</p><p>ä½ è¿˜å¯ä»¥é€‰æ‹©æ–‡ç« ä¸­çš„æ–¹æ³•äºŒï¼Œåœ¨manifestsç›®å½•ä¸‹æ·»åŠ  <code>local-storage.yaml.skip</code> æ–‡ä»¶ï¼Œè¿™æ ·ä¼šè®©k3sè·³è¿‡æŸä¸ªå®¹å™¨çš„æ„å»ºï¼Œä½†æˆ‘æ²¡æœ‰æµ‹è¯•å…¶æ˜¯å¦ä¼šå»é€‰æ‹©æˆ‘ä»¬è‡ªå®šä¹‰çš„é…ç½®æ–‡ä»¶ã€‚</p><p>æ¥ä¸‹æ¥è¿›è¡Œåˆ é™¤ï¼Œæ£€æµ‹ã€‚æœ€å¥½é‡å¯ä¸€ä¸‹k3s,<code>systemctl restart k3s</code></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>kubectl delete pod -n kube-system -l <span class=nv>app</span><span class=o>=</span>local-path-provisioner
</span></span><span class=line><span class=cl>kubectl get pods -n kube-system -l <span class=nv>app</span><span class=o>=</span>local-path-provisioner
</span></span><span class=line><span class=cl>kubectl describe pod &lt;PodName&gt; -n kube-system
</span></span></code></pre></div><h2 id=æ€»ç»“>æ€»ç»“<a hidden class=anchor aria-hidden=true href=#æ€»ç»“>#</a></h2><p>ç»å†äº† coreDNS å’Œ local-path-provisioner è¿™ä¸¤ä¸ªç³»ç»Ÿçº§åˆ«çš„é•œåƒä¹‹åï¼Œæˆ‘å¼€å§‹åæ€æ•´ä¸ªé€‚é…è¿‡ç¨‹ï¼Œæˆ‘è§‰å¾—åº”è¯¥å…ˆå»çœ‹çœ‹å¦‚ä½•ä»å¤´é€‚é…ï¼Œå³ä½¿ OREV çš„å…´è¶£å°ç»„å…ˆè¿›è¡Œäº†ä¸€ä¸ªåŸºç¡€é€‚é…ï¼Œä½¿å¾—æˆ‘ä»¬å¯ä»¥å…ˆä¸‹è½½åˆ° k3sã€‚</p><p>google åå‘ç°åœ¨å®˜æ–¹çš„ISSUEä¸­æœ‰è¿™ä¸ª<a href=https://github.com/rancher/image-mirror/issues/502>é€‚é…é—®é¢˜</a>,å…¶ä¸­æåˆ°ä¸€ä¸ªå·¨å¤§æŒ‘æˆ˜æ˜¯rancher-mirrored é•œåƒä¸­ç¼ºä¹å¯¹ riscv å¹³å°çš„æ”¯æŒã€‚</p><p>è¿™ä¹Ÿæ­£æ˜¯æˆ‘ä»¬ä¹‹å‰å¤„ç†çš„é‚£äº›é•œåƒï¼Œé»˜è®¤æ˜¯æ‹‰å–çš„ rancher å®˜æ–¹ç»´æŠ¤çš„é•œåƒå‰¯æœ¬ <strong>rancher-mirrored</strong>,æˆ‘ä»¬ä¹Ÿå¯¹è¿™äº›é•œåƒåšäº†é€‚é…ã€‚(åæ¥çŸ¥é“å¯ä»¥ä¿®æ”¹é»˜è®¤é•œåƒä»“åº“,åœ¨å¯åŠ¨å‘½ä»¤æ—¶åŠ ä¸Šç§æœ‰çš„ä»“åº“å³å¯)</p><blockquote><p>While we could simply add this to the arch list, this would change the multi-arch digest for any tags that we currently mirror that have this platform available.</p></blockquote><p>ä¸‹é¢ä¹Ÿæåˆ°è™½ç„¶å¯ä»¥ç®€å•åœ°å°† riscv æ·»åŠ åˆ°é•œåƒçš„æ¶æ„åˆ—è¡¨ä¸­ï¼Œä½†ä¼šå¯¼è‡´å½“å‰é•œåƒçš„å¤šæ¶æ„ digest å‘ç”Ÿå˜åŒ–ã€‚</p><ul><li>é•œåƒçš„ digest æ˜¯é•œåƒçš„å”¯ä¸€æ ‡è¯†ï¼Œä¸€ä¸ªå“ˆå¸Œå€¼ <code>sha256:xxx</code></li><li>æˆ‘ä»¬å¹³æ—¶ç”¨çš„é•œåƒåç§°ï¼Œå…¶å®å°±æ˜¯ tagï¼ŒæŒ‡å‘çš„æ˜¯ä¸€ä¸ª<strong>å¤šæ¶æ„çš„manifest</strong>,è¿™ä¸ª manifest ä¼šåˆ—å‡ºæ‰€æœ‰å¯¹åº”æ¶æ„çš„é•œåƒ(è§ä¸‹æ–¹å›¾åƒ)</li><li>manifest list æœ¬èº«æ˜¯ä¸€ä¸ª JSON æ–‡ä»¶,ä»–ä¹Ÿæœ‰ digest æ ‡è¯†;å¦‚æœæ·»åŠ ä¸€ä¸ª riscv å­—æ®µè¿›å»ï¼Œæ•´ä¸ª JSON å†…å®¹å˜åŒ–å¯¼è‡´ digest å˜åŒ–</li><li>å¾ˆå¤šç”Ÿäº§ç³»ç»Ÿ,CI/CD éƒ½ä¾èµ–è¿™ä¸ªç¨³å®šå¯éªŒè¯çš„ digest,è¿™å°±å¯¼è‡´ç‰µä¸€å‘è€ŒåŠ¨å…¨èº«, ä¼šé‡æ–°æ‹‰å–é•œåƒï¼Œæ‰“ç ´ç¼“å­˜ï¼›æŸäº›ç³»ç»Ÿä¼šè¯¯ä»¥ä¸ºå†…å®¹è¢«ç¯¡æ”¹æˆ–æ›´æ–°äº†ï¼Œé€ æˆæ„å¤–åæœ;ä¸åˆ©äºé•œåƒçš„åŒæ­¥å’Œç®¡ç†</li><li>æ›´æ„¿æ„çš„åšæ³•æ˜¯:<strong>ä¸æ”¹å˜ç°æœ‰ç‰ˆæœ¬(åŠä¹‹å‰ç‰ˆæœ¬)çš„é•œåƒ manifest,åœ¨æ–°çš„ç‰ˆæœ¬ä¸­æ·»åŠ å¯¹æ–°æ¶æ„çš„æ”¯æŒ</strong>.</li></ul><p><img alt=2 loading=lazy src=/img/riscv/manifest.png></p><blockquote><p>We should figure out how to add this platform to only new tags, in a way that is minimally disruptive to the list maintenance process, and can be reused when adding new platforms in the future.</p></blockquote><p>è¿™æ˜¯ä»–ä»¬æå‡ºçš„è§£å†³æ–¹æ³•ï¼Œåªå°† RISC-V å¹³å°æ·»åŠ åˆ°**æ–°æ ‡ç­¾ï¼ˆæ–°çš„ manifest,æ–°çš„é•œåƒï¼‰**ä¸­ï¼Œè¿™æ ·å¯¹é•œåƒåˆ—è¡¨çš„ç»´æŠ¤å¹²æ‰°æœ€å°ã€‚</p><p>ä¸ºäº†ä¿è¯é•œåƒçš„ç¨³å®šæ€§ï¼ŒK3s å›¢é˜Ÿä¸ä¿®æ”¹å·²æœ‰é•œåƒçš„å¤šæ¶æ„é…ç½®ï¼Œè€Œæ˜¯åªç»™æ–°æ·»åŠ çš„é•œåƒæ„å»º RISC-V ç‰ˆæœ¬ï¼Œé  git blame + æ—¶é—´åŒºé—´æ§åˆ¶ï¼Œç¡®ä¿ digest ä¸å˜ä¸”æµç¨‹å¯å¤ç”¨ã€‚</p><p>ä½†æ˜¯åç»­çš„è®¨è®ºå°±å›´ç»•ç€è¯¥å¦‚ä½•æ”¯æŒæ–°çš„æ¶æ„ï¼Œå®˜æ–¹å¼€å‘è€…æ›´å€¾å‘äºå¯¹æ–°çš„é•œåƒåŠ å…¥æ–°çš„æ¶æ„è€Œä¸å»æ”¹åŠ¨è€çš„é•œåƒï¼Œè¿™æ˜¯å¾ˆå¥½ç†è§£çš„ç­–ç•¥ã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†æ¢ç´¢å…¶ä»–ç³»ç»Ÿçº§åˆ«é•œåƒ,ä¾‹å¦‚ Helm,Traefik</p><p><strong>è¿™é‡Œæ˜¯LTXï¼Œæ„Ÿè°¢æ‚¨é˜…è¯»è¿™ç¯‡åšå®¢ï¼Œäººç”Ÿæµ·æµ·ï¼Œå’Œè‡ªå·±å¯¹è¯ï¼Œåƒåªè´è¶çºµæ¨ªå››æµ·ã€‚</strong></p><h2 id=åç»­æ›´æ–°>åç»­æ›´æ–°<a hidden class=anchor aria-hidden=true href=#åç»­æ›´æ–°>#</a></h2><p>å¯ä»¥å‘ç° rancher å®˜æ–¹æä¾›äº†å…³äº local-path-provisioner åœ¨ riscv ä¸Šçš„é•œåƒ.</p><p><img alt=3 loading=lazy src=/img/riscv/local1.png></p><p>æ‰€ä»¥å¤§ä½¬åœ¨ commit ä¸­åªæ˜¯ä¿®æ”¹äº†å…¶ç‰ˆæœ¬åˆ°29.</p><p>æ•…æˆ‘ä»¬åªéœ€è¦å°†å…¶æ‹‰å–åˆ°æœ¬åœ°å¹¶æ¨é€åˆ°ç§æœ‰é•œåƒä»“åº“å³å¯.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://LTXWorld.github.io/tags/k3s/>K3s</a></li><li><a href=https://LTXWorld.github.io/tags/local-storage/>Local-Storage</a></li><li><a href=https://LTXWorld.github.io/tags/riscv/>RiscV</a></li></ul><nav class=paginav><a class=prev href=https://LTXWorld.github.io/posts/021%E5%A5%87%E6%80%9D%E4%B9%B1%E6%83%B3ep02%E6%B6%88%E8%B4%B9%E8%A7%82%E4%B8%8E%E9%98%85%E8%AF%BB/><span class=title>Â« ä¸Šä¸€é¡µ</span><br><span>LTçš„å¥‡æ€ä¹±æƒ³EP02ç²¾æ°”ç¥â€”â€”æ¶ˆè´¹è§‚ä¸é˜…è¯»</span>
</a><a class=next href=https://LTXWorld.github.io/posts/019golangep03_slice%E5%BA%95%E5%B1%82%E5%8E%9F%E7%90%86%E5%8F%8A%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9/><span class=title>ä¸‹ä¸€é¡µ Â»</span><br><span>GolangEP03_sliceåº•å±‚åŸç†åŠæ³¨æ„äº‹é¡¹</span></a></nav></footer><div id=tw-comment></div><script>const getStoredTheme=()=>localStorage.getItem("pref-theme")==="light"?"light":"dark",setGiscusTheme=()=>{const e=e=>{const t=document.querySelector("iframe.giscus-frame");t&&t.contentWindow.postMessage({giscus:e},"https://giscus.app")};e({setConfig:{theme:getStoredTheme()}})};document.addEventListener("DOMContentLoaded",()=>{const s={src:"https://giscus.app/client.js","data-repo":"LTXWorld/LTXWorld.github.io","data-repo-id":"R_kgDONODUuA","data-category":"Announcements","data-category-id":"DIC_kwDONODUuM4CkMUw","data-mapping":"pathname","data-strict":"0","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":getStoredTheme(),"data-lang":"zh-CN","data-loading":"lazy",crossorigin:"anonymous"},e=document.createElement("script");Object.entries(s).forEach(([t,n])=>e.setAttribute(t,n)),document.querySelector("#tw-comment").appendChild(e);const t=document.querySelector("#theme-toggle");t&&t.addEventListener("click",setGiscusTheme);const n=document.querySelector("#theme-toggle-float");n&&n.addEventListener("click",setGiscusTheme)})</script></article></main><footer class=footer><span><a href=https://LTXWorld.github.io/>Â©2025 LTX&rsquo;s Blog</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><div class=ltx-music-player id=ltx-music-player role=group aria-label=èƒŒæ™¯éŸ³ä¹æ’­æ”¾å™¨><audio id=ltx-music-audio preload=metadata></audio><div class=ltx-drag-handle data-role=drag-handle title=ä¸Šä¸‹æ‹–åŠ¨è°ƒæ•´ä½ç½®></div><div class=ltx-music-header><div class=ltx-music-visual><div class=ltx-disc data-role=disc aria-hidden=true><img data-role=cover alt loading=lazy decoding=async><div class=ltx-disc-center></div></div></div><div class=ltx-music-meta><span class=ltx-music-title data-role=title></span>
<span class=ltx-music-artist data-role=artist></span></div><button type=button class=ltx-music-hide data-action=collapse aria-label=éšè—æ’­æ”¾å™¨>&#215;</button></div><div class=ltx-music-progress data-role=progress aria-label=è¿›åº¦æ¡ role=slider><div class=ltx-music-progress-fill data-role=progress-fill></div></div><div class=ltx-music-time><span data-role=current>0:00</span>
<span data-role=total>--:--</span></div><div class=ltx-music-controls><button type=button data-action=prev aria-label=ä¸Šä¸€é¦–>â®</button>
<button type=button data-action=toggle aria-label=æ’­æ”¾æˆ–æš‚åœ>
<span data-icon=play>â–¶</span>
<span data-icon=pause>â¸</span>
</button>
<button type=button data-action=next aria-label=ä¸‹ä¸€é¦–>â­</button>
<button type=button data-action=mute aria-label=é™éŸ³æˆ–å–æ¶ˆé™éŸ³>
<span data-icon=unmuted>ğŸ”Š</span>
<span data-icon=muted>ğŸ”‡</span></button></div><div class=ltx-autoplay-tip data-role=tip aria-live=polite></div></div><button type=button class=ltx-music-fab id=ltx-music-fab aria-label=æ˜¾ç¤ºéŸ³ä¹æ’­æ”¾å™¨>&#9835;</button>
<script>window.LTX_MUSIC_CONFIG={autoplay:!0,defaultCover:"",loopPlaylist:!0,startVolume:.6,tracks:[{artist:"ç‹åŠ›å®",file:"/audio/02 - ä¾ç„¶çˆ±ä½ .mp3",title:"ä¾ç„¶çˆ±ä½ "},{artist:"ç‹åŠ›å®",file:"/audio/05 - æ”¹å˜è‡ªå·±.mp3",title:"æ”¹å˜è‡ªå·±"},{artist:"ç‹åŠ›å®",file:"/audio/11 - çˆ±é”™.mp3",title:"çˆ±é”™"}]},function(){const a=window.LTX_MUSIC_CONFIG||{};if(!a.tracks||!a.tracks.length)return;const e=document.getElementById("ltx-music-player"),t=e.querySelector("audio"),x=e.querySelector('[data-role="title"]'),O=e.querySelector('[data-role="artist"]'),b=e.querySelector('[data-role="progress"]'),A=e.querySelector('[data-role="progress-fill"]'),F=e.querySelector('[data-role="current"]'),M=e.querySelector('[data-role="total"]'),c=e.querySelector('[data-role="tip"]'),r=e.querySelector('[data-role="cover"]'),S=e.querySelector('[data-action="toggle"]'),y=e.querySelector('[data-action="prev"]'),k=e.querySelector('[data-action="next"]'),E=e.querySelector('[data-action="mute"]'),g=e.querySelector('[data-action="collapse"]'),i=e.querySelector('[data-role="drag-handle"]'),o=document.getElementById("ltx-music-fab"),f=(e,t,n)=>Math.min(Math.max(e,t),n),j=e=>{if(!Number.isFinite(e))return"--:--";const t=Math.floor(e/60),n=Math.floor(e%60);return`${String(t).padStart(1,"0")}:${String(n).padStart(2,"0")}`},C=-120,_=220,w=180,s={active:!1,startY:0,startOffset:0,pointerId:null},n={index:0,tracks:a.tracks,autoplay:a.autoplay!==!1,loopPlaylist:a.loopPlaylist!==!1,offset:0,collapsed:!1},h=t=>{n.offset=f(t,C,_),e.style.setProperty("--ltx-offset",`${n.offset}px`)},l=t=>{const s=Boolean(t);n.collapsed=s,e.classList.toggle("ltx-collapsed",s),s?(e.classList.remove("ltx-dragging"),n.offset=0,e.style.removeProperty("--ltx-offset"),o&&(o.classList.add("ltx-visible"),o.setAttribute("aria-hidden","false"),o.tabIndex=0)):(h(0),o&&(o.classList.remove("ltx-visible"),o.setAttribute("aria-hidden","true"),o.tabIndex=-1))},m=()=>{const n=t.muted||t.volume===0;e.classList.toggle("ltx-muted",n)};t.volume=f(a.startVolume??.6,0,1),m(),l(!1);const d=()=>{const e=t.duration||0,n=t.currentTime||0,s=e?n/e*100:0;A.style.width=`${s}%`,F.textContent=j(n),M.textContent=j(e)},u=(s,o={})=>{const l=n.tracks.length;n.index=(s%l+l)%l;const i=n.tracks[n.index];if(!i||!i.file){console.warn("LTX music player: éŸ³é¢‘æ–‡ä»¶ç¼ºå¤±",i),c.textContent="éŸ³é¢‘æ–‡ä»¶ç¼ºå¤±ï¼Œè¯·æ£€æŸ¥é…ç½®";return}const u=i.cover||a.defaultCover||"";r&&(u?(r.src=u,r.alt=i.title?`${i.title} å°é¢`:"éŸ³ä¹å°é¢",e.classList.add("ltx-has-cover")):(r.removeAttribute("src"),r.alt="",e.classList.remove("ltx-has-cover"))),x.textContent=i.title||`Track ${n.index+1}`,O.textContent=i.artist||"",t.src=i.file,e.dataset.trackIndex=n.index,c.textContent="",e.classList.remove("ltx-autoplay-blocked"),d(),o.play&&p()},p=()=>{t.play().then(()=>{e.classList.remove("ltx-autoplay-blocked"),c.textContent=""}).catch(()=>{e.classList.add("ltx-autoplay-blocked"),c.textContent="æµè§ˆå™¨é˜»æ­¢äº†è‡ªåŠ¨æ’­æ”¾ï¼Œè¯·ç‚¹å‡»æ’­æ”¾æŒ‰é’®"})},v=(e=!1)=>{const o=!t.paused||e,s=n.index+1;if(s>=n.tracks.length&&!n.loopPlaylist){t.currentTime=t.duration||0,t.pause();return}u(s,{play:o})},T=()=>{const e=!t.paused;u(n.index-1,{play:e})};if(g&&g.addEventListener("click",()=>l(!0)),o&&(o.addEventListener("click",()=>l(!1)),o.setAttribute("aria-hidden","true"),o.tabIndex=-1),i){i.style.touchAction="none",i.addEventListener("pointerdown",t=>{if(n.collapsed)return;if(s.active=!0,s.pointerId=t.pointerId,s.startY=t.clientY,s.startOffset=n.offset,i.setPointerCapture)try{i.setPointerCapture(t.pointerId)}catch{}e.classList.add("ltx-dragging")}),i.addEventListener("pointermove",e=>{if(!s.active)return;const t=e.clientY-s.startY;h(s.startOffset+t)});const t=()=>{if(!s.active)return;if(s.pointerId!==null&&i.releasePointerCapture)try{i.releasePointerCapture(s.pointerId)}catch{}s.active=!1,s.pointerId=null,e.classList.remove("ltx-dragging"),n.offset>w?l(!0):h(n.offset)};["pointerup","pointercancel"].forEach(e=>{i.addEventListener(e,t)}),i.addEventListener("pointerleave",()=>{if(!s.active)return;t()})}S.addEventListener("click",()=>{t.paused?p():t.pause()}),y.addEventListener("click",T),k.addEventListener("click",()=>v(!1)),E.addEventListener("click",()=>{t.muted=!t.muted,m()}),b.addEventListener("click",e=>{const n=b.getBoundingClientRect(),s=f((e.clientX-n.left)/n.width,0,1);Number.isFinite(t.duration)&&(t.currentTime=s*t.duration)}),t.addEventListener("timeupdate",d),t.addEventListener("loadedmetadata",d),t.addEventListener("play",()=>{e.classList.add("ltx-playing"),e.classList.remove("ltx-autoplay-blocked"),c.textContent=""}),t.addEventListener("pause",()=>{e.classList.remove("ltx-playing")}),t.addEventListener("ended",()=>{v(!0)}),t.addEventListener("volumechange",m),u(0,{play:n.autoplay})}()</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="å¤åˆ¶";function s(){t.innerHTML="å·²å¤åˆ¶ï¼",setTimeout(()=>{t.innerHTML="å¤åˆ¶"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>